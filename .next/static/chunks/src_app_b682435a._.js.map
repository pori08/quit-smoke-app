{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/porir/%E3%82%B3%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E4%BD%9C%E6%A5%AD%E7%94%A8/quit-smoke-app/src/app/firebase.ts"],"sourcesContent":["import { initializeApp } from \"firebase/app\";\nimport { getFirestore } from \"firebase/firestore\";\n\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n};\n\nconst app = initializeApp(firebaseConfig);\nconst db = getFirestore(app);\n\nexport { db };\n"],"names":[],"mappings":";;;AAIU;AAJV;AAAA;AACA;AAAA;;;AAEA,MAAM,iBAAiB;IACrB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;AACP;AAEA,MAAM,MAAM,CAAA,GAAA,mLAAA,CAAA,gBAAa,AAAD,EAAE;AAC1B,MAAM,KAAK,CAAA,GAAA,kKAAA,CAAA,eAAY,AAAD,EAAE","debugId":null}},
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/porir/%E3%82%B3%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E4%BD%9C%E6%A5%AD%E7%94%A8/quit-smoke-app/src/app/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { db } from \"./firebase\"\nimport { collection, getDocs, query, orderBy, doc, getDoc, setDoc } from \"firebase/firestore\"\nimport dayjs from \"dayjs\"\nimport isSameOrBefore from 'dayjs/plugin/isSameOrBefore'\nimport { CheckCircleIcon, FireIcon } from '@heroicons/react/24/solid'\nimport toast from 'react-hot-toast'\n\ndayjs.extend(isSameOrBefore)\n\nasync function fetchStreak(setStreak, setMoney, price) {\n  const q = query(collection(db, 'records'), orderBy('__name__', 'desc'))\n  const snap = await getDocs(q)\n  const map = new Map()\n  snap.forEach(d => map.set(d.id, d.data().success))\n  let count = 0\n  let cur = dayjs()\n  while (map.get(cur.format('YYYY-MM-DD')) === true) {\n    count++; cur = cur.subtract(1, 'day')\n  }\n  setStreak(count)\n  setMoney(count * price)\n}\n\nexport default function Dashboard() {\n  const [quitDate, setQuitDate] = useState<string>(\"\")\n  const [streak,  setStreak]    = useState<number>(0)\n  const [money,   setMoney]     = useState<number>(0)\n  const [price,   setPrice]     = useState<number>(600)\n\n  // ★ 最初に Firestore から各種設定を読み込む\n  useEffect(() => {\n    const load = async () => {\n      const ref = doc(db, \"userConfig\", \"default\")\n      const snap = await getDoc(ref)\n      if (snap.exists()) {\n        const data = snap.data()\n        setQuitDate(data.quitDate || \"\")\n        setPrice(data.price || 600)\n      }\n    }\n    load()\n  }, [])\n\n  // ★ quitDate が変わるたび Streak を計算\n  useEffect(() => {\n    if (!quitDate) return\n    fetchStreak(setStreak, setMoney, price)\n  }, [quitDate, price])\n\n  // ★ カレンダー変更 → Firestore に保存\n  const handleChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const val = e.target.value\n    setQuitDate(val)\n    await setDoc(doc(db, \"userConfig\", \"default\"), { quitDate: val }, { merge: true })\n  }\n\n  // ★ 価格変更 → Firestore に保存\n  const handlePriceChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newPrice = Number(e.target.value)\n    setPrice(newPrice)\n    await setDoc(doc(db, \"userConfig\", \"default\"), { price: newPrice }, { merge: true })\n  }\n\n  return (\n    <main className=\"p-4 space-y-6 bg-gradient-to-b from-gray-200 to-gray-100 min-h-screen\">\n      <h1 className=\"text-3xl font-bold mb-4\">禁煙ダッシュボード</h1>\n\n      {/* Settings */}\n      <div className=\"space-y-4\">\n        <section className=\"bg-white shadow p-4 rounded-2xl\">\n          <label className=\"block text-sm mb-1\">禁煙開始日</label>\n          <p className=\"text-xs text-gray-500 mb-2\">禁煙を始めた日付を設定します。</p>\n          <input\n            type=\"date\"\n            value={quitDate}\n            onChange={handleChange}\n            max={dayjs().format(\"YYYY-MM-DD\")}\n            className=\"border px-2 py-1 rounded w-full\"\n          />\n        </section>\n        <section className=\"bg-white shadow p-4 rounded-2xl\">\n          <label className=\"block text-sm mb-1\">タバコ一箱の価格 (円)</label>\n          <p className=\"text-xs text-gray-500 mb-2\">節約金額の計算に使用します。</p>\n          <input\n            type=\"number\"\n            value={price}\n            onChange={handlePriceChange}\n            className=\"border px-2 py-1 rounded w-full\"\n          />\n        </section>\n      </div>\n\n      {/* Streak & Money */}\n      <div className=\"flex flex-col md:flex-row gap-4\">\n        <section className=\"flex-1 bg-white shadow p-4 rounded-2xl\">\n          <label className=\"block text-sm\">継続日数</label>\n          <p className=\"text-xs text-gray-500 mb-2\">禁煙が継続している日数です。</p>\n          <p className=\"text-4xl font-bold\">{streak} days</p>\n        </section>\n        <section className=\"flex-1 bg-white shadow p-4 rounded-2xl\">\n          <label className=\"block text-sm\">節約金額</label>\n          <p className=\"text-xs text-gray-500 mb-2\">禁煙によって節約できた金額です。</p>\n          <p className=\"text-4xl font-bold\">¥{money.toLocaleString()}</p>\n        </section>\n      </div>\n    {/* Action Buttons */}\n<div className=\"flex justify-center gap-6 pt-8\">\n  {/* 成功ボタン */}\n  <button\n    onClick={async () => {\n      const today = dayjs().format(\"YYYY-MM-DD\");\n      await setDoc(doc(db, \"records\", today), { success: true }, { merge: true });\n      toast.success('記録しました！');\n      await fetchStreak(setStreak, setMoney, price)\n    }}\n    className=\"px-4 py-2 bg-green-600 text-white rounded-xl hover:bg-green-700 flex items-center space-x-2\"\n  >\n    <CheckCircleIcon className=\"h-5 w-5\" />\n    <span>今日吸わなかった</span>\n  </button>\n\n  {/* 衝動ボタン */}\n  <button\n    onClick={async () => {\n      const today = dayjs().format(\"YYYY-MM-DD\");\n      await setDoc(doc(db, \"records\", today), { success: false }, { merge: true });\n      toast.error('深呼吸して落ち着こう');\n      await fetchStreak(setStreak, setMoney, price)\n    }}\n    className=\"px-4 py-2 bg-orange-500 text-white rounded-xl hover:bg-orange-600 flex items-center space-x-2\"\n  >\n    <FireIcon className=\"h-5 w-5\" />\n    <span>吸いたい衝動が来た</span>\n  </button>\n</div>\n</main>\n  )\n}"],"names":[],"mappings":"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","debugId":null}}]
}